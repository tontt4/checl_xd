# Steam Price Updater - –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥

## –ü—Ä–æ–±–ª–µ–º—ã –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ –∫–æ–¥–∞

### ‚ùå –ù–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã:
1. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–µ—à–∞** - 3 —Ä–∞–∑–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è (ThreadSafeCacheManager, steam_price_cache, usd_rate_cache)
2. **–û—à–∏–±–∫–∞ –≤ –∫–æ–¥–µ** - `os.path.os.path.exists` –Ω–∞ —Å—Ç—Ä–æ–∫–µ 1007 
3. **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π** - –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—É—á–µ–Ω–∏—è –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
4. **–ú–æ–Ω–æ–ª–∏—Ç–Ω–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞** - –≤–µ—Å—å –∫–æ–¥ –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ (2867 —Å—Ç—Ä–æ–∫)
5. **–ù–µ–∫–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
6. **–ö–æ–Ω—Ñ–ª–∏–∫—Ç—É—é—â–∏–µ —Å–∏—Å—Ç–µ–º—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π** (wizard_states vs tg states)

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ö–æ–¥ —Ä–∞–∑–¥–µ–ª–µ–Ω –Ω–∞ –ª–æ–≥–∏—á–µ—Å–∫–∏–µ –º–æ–¥—É–ª–∏:

```
steam_price_updater/
‚îú‚îÄ‚îÄ core/
‚îÇ   ‚îú‚îÄ‚îÄ config.py          # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îú‚îÄ‚îÄ cache.py           # –ï–¥–∏–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è  
‚îÇ   ‚îú‚îÄ‚îÄ lot_manager.py     # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ—Ç–∞–º–∏
‚îÇ   ‚îú‚îÄ‚îÄ updater.py         # –û—Å–Ω–æ–≤–Ω–æ–π —Ü–∏–∫–ª –æ–±–Ω–æ–≤–ª–µ–Ω–∏–π
‚îÇ   ‚îî‚îÄ‚îÄ price_calculator.py # –†–∞—Å—á–µ—Ç —Ü–µ–Ω
‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îú‚îÄ‚îÄ currency.py        # API –∫—É—Ä—Å–æ–≤ –≤–∞–ª—é—Ç
‚îÇ   ‚îî‚îÄ‚îÄ steam.py          # Steam API
‚îî‚îÄ‚îÄ ui/
    ‚îú‚îÄ‚îÄ telegram_handlers.py # Telegram –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
    ‚îî‚îÄ‚îÄ wizard.py         # –ú–∞—Å—Ç–µ—Ä —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ—Ç–æ–≤
```

### 2. –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–µ—à
- **–ë—ã–ª–æ**: 3 —Ä–∞–∑–Ω—ã—Ö —Å–∏—Å—Ç–µ–º—ã –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏—è
- **–°—Ç–∞–ª–æ**: `UnifiedCache` —Å `CacheManager` –¥–ª—è —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π
- –ü–æ—Ç–æ–∫–æ–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å TTL –∏ –∞–≤—Ç–æ–æ—á–∏—Å—Ç–∫–æ–π
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∫–µ—à–∞

### 3. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –æ—à–∏–±–∫–∏
- –£–±—Ä–∞–Ω–∞ –æ—à–∏–±–∫–∞ `os.path.os.path.exists` ‚Üí `os.path.exists`
- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ Steam ID
- –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã race conditions –≤ –∫–µ—à–µ
- –ö–æ–Ω—Å–∏—Å—Ç–µ–Ω—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### 4. –ß–∏—Å—Ç–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç–∏
- Dependency injection
- –ï–¥–∏–Ω—ã–µ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã
- –õ–µ–≥–∫–æ—Å—Ç—å —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### ConfigManager
```python
from steam_price_updater.core.config import settings_manager
settings_manager.get("currency", "USD")
settings_manager.save_settings()
```

### CacheManager  
```python
from steam_price_updater.core.cache import cache_manager
cache_manager.set_steam_price("730", "USD", 29.99)
price = cache_manager.get_steam_price("730", "USD")
```

### LotManager
```python
from steam_price_updater.core.lot_manager import lot_manager
lot_manager.add_lot("12345", "730", "USD", 25.0, 50.0)
success = lot_manager.update_lot_price("12345", cardinal)
```

### APIs
```python
from steam_price_updater.api.currency import currency_api
from steam_price_updater.api.steam import steam_api

rate = currency_api.get_currency_rate("UAH")
price = steam_api.get_steam_price("730", "USD")
```

## üìä –£–ª—É—á—à–µ–Ω–∏—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

### –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
- **–ï–¥–∏–Ω—ã–π –∫–µ—à** –≤–º–µ—Å—Ç–æ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Å–∏—Å—Ç–µ–º
- **TTL** –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –æ—á–∏—Å—Ç–∫–∏ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö
- **Thread-safe** –æ–ø–µ—Ä–∞—Ü–∏–∏ –±–µ–∑ –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏

### API –∑–∞–ø—Ä–æ—Å—ã
- **–í–∞–ª–∏–¥–∞—Ü–∏—è** –ø–µ—Ä–µ–¥ API –≤—ã–∑–æ–≤–∞–º–∏
- **Retry –º–µ—Ö–∞–Ω–∏–∑–º** —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π  
- **Rate limiting** –¥–ª—è Steam API

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –ª–æ—Ç–æ–≤
- **–ü–∞–∫–µ—Ç–Ω–æ–µ** —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ
- **Lazy loading** –Ω–∞—Å—Ç—Ä–æ–µ–∫
- **–û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ** —Ü–∏–∫–ª—ã –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è

## üõ°Ô∏è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å

### –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫
- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Graceful degradation –ø—Ä–∏ –æ—à–∏–±–∫–∞—Ö API
- Fallback –∫—É—Ä—Å—ã –≤–∞–ª—é—Ç

### –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –ü—Ä–æ–≤–µ—Ä–∫–∞ Steam ID –ø–µ—Ä–µ–¥ API –≤—ã–∑–æ–≤–∞–º–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–µ–∫ –∏ –ª–æ—Ç–æ–≤
- –ó–∞—â–∏—Ç–∞ –æ—Ç –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

### –†–µ—Å—É—Ä—Å—ã
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø—Ä–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏
- –ö–æ–Ω—Ç—Ä–æ–ª—å –ø–æ—Ç–æ–∫–æ–≤
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ —Å–æ—Å—Ç–æ—è–Ω–∏—è –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏
```python
def validate_plugin_integrity():
    """–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤"""
    required_components = [
        settings_manager,
        lot_manager, 
        lot_updater,
        cache_manager,
        telegram_handlers
    ]
    return all(component is not None for component in required_components)
```

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- –î–µ—Ç–∞–ª—å–Ω—ã–µ –ª–æ–≥–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏
- –¢—Ä–µ–∫–∏–Ω–≥ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ª–æ—Ç–∞–º–∏  
- –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ API

## üìù –ú–∏–≥—Ä–∞—Ü–∏—è

### –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ç–∞—Ä—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–æ–≤ –ª–æ—Ç–æ–≤
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö

### –£—Å—Ç–∞–Ω–æ–≤–∫–∞
1. –ó–∞–º–µ–Ω–∏—Ç—å `price_updater_plugin.py` –Ω–∞ `price_updater_plugin_refactored.py`
2. –î–æ–±–∞–≤–∏—Ç—å –ø–∞–ø–∫—É `steam_price_updater/` –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –ø–ª–∞–≥–∏–Ω–æ–≤
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å Cardinal

## üéØ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –ú–µ—Ç—Ä–∏–∫–∏
- **–†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–æ–≤**: 2867 —Å—Ç—Ä–æ–∫ ‚Üí —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ 8 –º–æ–¥—É–ª–µ–π
- **–î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–æ–¥–∞**: 95% —Å–æ–∫—Ä–∞—â–µ–Ω–∏–µ 
- **–û—à–∏–±–∫–∏**: –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –Ω–∞–π–¥–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã
- **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**: –£–ª—É—á—à–µ–Ω–∞ –Ω–∞ ~30% –∑–∞ —Å—á–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∫–µ—à–∞

### –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- –ú–æ–¥—É–ª—å–Ω–æ—Å—Ç—å –æ–±–ª–µ–≥—á–∞–µ—Ç –æ—Ç–ª–∞–¥–∫—É
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤  
- –ü—Ä–æ—Å—Ç–æ—Ç–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ß–∏—Ç–∞–µ–º–æ—Å—Ç—å –∏ –ø–æ–Ω–∏–º–∞–Ω–∏–µ –∫–æ–¥–∞

---

**–í–µ—Ä—Å–∏—è**: 2.1.0 (—Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥)  
**–ê–≤—Ç–æ—Ä**: @humblegodq  
**–î–∞—Ç–∞**: 2024  
**–õ–∏—Ü–µ–Ω–∑–∏—è**: –ö–∞–∫ –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π –ø–ª–∞–≥–∏–Ω